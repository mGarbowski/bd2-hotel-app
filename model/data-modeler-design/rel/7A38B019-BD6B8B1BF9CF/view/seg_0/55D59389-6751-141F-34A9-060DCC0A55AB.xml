<?xml version = '1.0' encoding = 'UTF-8'?>
<TableView class="oracle.dbtools.crest.model.design.relational.TableView" directorySegmentName="seg_0" id="55D59389-6751-141F-34A9-060DCC0A55AB" name="payments_summary">
<createdBy>mgarbowski</createdBy>
<createdTime>2024-05-24 10:41:38 UTC</createdTime>
<generatorID>23EB9697-022A-BA3F-9CAF-B5F8FED60427</generatorID>
<ownerDesignName>data-modeler-design</ownerDesignName>
<userDefined>true</userDefined>
<userDefinedSQL><![CDATA[SELECT gen_random_uuid()                                      AS id,
       b.id                                                   AS booking_id,
       'Reservation fee'                                      AS name,
       -1 * (b.end_date - b.start_date + 1) * a.price_per_day AS amount
FROM booking b
         JOIN apartment a on b.apartment_id = a.id
UNION ALL
SELECT gen_random_uuid() AS id, b.id AS booking_id, s.name, -1 * s.price
FROM extra_service s
         JOIN available_service avs ON s.id = avs.extra_service_id
         JOIN extra_service_order so
              ON so.available_service_hotel_id = avs.hotel_id AND
                 so.available_service_extra_service_id = avs.extra_service_id
         JOIN booking b ON so.booking_id = b.id
UNION ALL
SELECT gen_random_uuid() AS id, b.id AS booking_id, 'Payment' AS name, p.amount
FROM payment p
         JOIN booking b ON p.booking_id = b.id;]]></userDefinedSQL>
<parsed>true</parsed>
<usedContainers>
<container alias="b" containerID="BF7E1138-756C-457A-FD65-2893DF2EFDB2"/>
</usedContainers>
<viewElements>
<viewElement class="oracle.dbtools.crest.model.design.relational.ColumnView" name="id" id="10C40F80-A2C3-E36C-8F96-AB1381EF7BA4">
<createdBy>mgarbowski</createdBy>
<createdTime>2024-05-24 10:41:38 UTC</createdTime>
<generatorID>DCD17ACA-1319-B350-4C8B-44725C605B07</generatorID>
<ownerDesignName>data-modeler-design</ownerDesignName>
<nullsAllowed>true</nullsAllowed>
<useDomainConstraints>false</useDomainConstraints>
<alias>id</alias>
<dataType>UNKNOWN</dataType>
<expression>gen_random_uuid()</expression>
<reference>false</reference>
<viewID>55D59389-6751-141F-34A9-060DCC0A55AB</viewID>
</viewElement>
<viewElement class="oracle.dbtools.crest.model.design.relational.ColumnView" name="booking_id" id="D04B48C9-744B-D616-D937-A4FC3587649B">
<createdBy>mgarbowski</createdBy>
<createdTime>2024-05-24 10:41:38 UTC</createdTime>
<generatorID>E34ED66A-6277-DA38-483C-9F1D7EE7A031</generatorID>
<ownerDesignName>data-modeler-design</ownerDesignName>
<nullsAllowed>true</nullsAllowed>
<useDomainConstraints>false</useDomainConstraints>
<alias>booking_id</alias>
<dataType>INTEGER</dataType>
<reference>false</reference>
<referencedColumn>C9A199C6-85E3-EF9F-ADA6-78D2C3B28356</referencedColumn>
<table>BF7E1138-756C-457A-FD65-2893DF2EFDB2</table>
<tableAlias>b</tableAlias>
<viewID>55D59389-6751-141F-34A9-060DCC0A55AB</viewID>
</viewElement>
<viewElement class="oracle.dbtools.crest.model.design.relational.ColumnView" name="name" id="3249B2BA-0F5C-0F81-C265-E8DBC062F50D">
<createdBy>mgarbowski</createdBy>
<createdTime>2024-05-24 10:41:38 UTC</createdTime>
<generatorID>6C3ACBB2-9E5A-6F03-ECC9-4FF304AF6858</generatorID>
<ownerDesignName>data-modeler-design</ownerDesignName>
<nullsAllowed>true</nullsAllowed>
<useDomainConstraints>false</useDomainConstraints>
<alias>name</alias>
<dataType>UNKNOWN</dataType>
<expression>&apos;Reservation fee&apos;</expression>
<reference>false</reference>
<viewID>55D59389-6751-141F-34A9-060DCC0A55AB</viewID>
</viewElement>
<viewElement class="oracle.dbtools.crest.model.design.relational.ColumnView" name="amount" id="42166A66-2DFB-2520-D73A-9E7D7A1E545E">
<createdBy>mgarbowski</createdBy>
<createdTime>2024-05-24 10:41:38 UTC</createdTime>
<generatorID>CABD8911-8424-C734-54FA-C433FA501BE0</generatorID>
<ownerDesignName>data-modeler-design</ownerDesignName>
<nullsAllowed>true</nullsAllowed>
<useDomainConstraints>false</useDomainConstraints>
<alias>amount</alias>
<dataType>NUMBER</dataType>
<expression> -1 * (b.end_date - b.start_date + 1) * a.price_per_day</expression>
<reference>false</reference>
<viewID>55D59389-6751-141F-34A9-060DCC0A55AB</viewID>
</viewElement>
</viewElements>
<usedObjects>
<UsedObject class="oracle.dbtools.crest.swingui.editor.viewbuilder.SQLNameHelper" id="BF7E1138-756C-457A-FD65-2893DF2EFDB2">
<container>true</container>
<tableName>booking</tableName>
</UsedObject>
<UsedObject class="oracle.dbtools.crest.swingui.editor.viewbuilder.SQLNameHelper" id="08103B54-062A-82BF-D529-06EAC711F48E">
<container>true</container>
<tableName>apartment</tableName>
</UsedObject>
<UsedObject class="oracle.dbtools.crest.swingui.editor.viewbuilder.SQLNameHelper" id="54FE7E33-73B2-D6FB-2F02-9DE208333D47">
<container>true</container>
<tableName>payment</tableName>
</UsedObject>
<UsedObject class="oracle.dbtools.crest.swingui.editor.viewbuilder.SQLNameHelper" id="C9A199C6-85E3-EF9F-ADA6-78D2C3B28356">
<columnName>id</columnName>
<tableName>booking</tableName>
</UsedObject>
<UsedObject class="oracle.dbtools.crest.swingui.editor.viewbuilder.SQLNameHelper" id="63D3802B-0E32-C1CF-A0C6-18176F213AA9">
<columnName>id</columnName>
<tableName>apartment</tableName>
</UsedObject>
<UsedObject class="oracle.dbtools.crest.swingui.editor.viewbuilder.SQLNameHelper" id="5D577496-D732-6377-BC9D-A889EFFF5C35">
<columnName>amount</columnName>
<tableName>payment</tableName>
</UsedObject>
</usedObjects>
</TableView>
